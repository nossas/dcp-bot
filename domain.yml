version: '3.1'
session_config:
  session_expiration_time: 10
  carry_over_slots_to_new_session: false

intents:
- fallback_texto
- alterar_nome
- inatividade_timeout
- inatividade_monitoramento
- saudacao
- informar_nome
- deny_name
- affirm_name
- deny_address
- affirm_address
- informar_risco
- informar_endereco_texto
- informar_localizacao
- informar_classificacao_risco
- informar_descricao_risco
- pular_descricao_risco
- pular_enviar_midia_risco
- tentar_novamente
- receber_midia_risco
- afirmar_confirmacao_risco
- recusar_confirmacao_risco
- menu_inicial
- situacao_no_jacare
- preciso_de_ajuda
- contatos_emergencia
# - dicas_de
# - menu_dicas
- sair
- receber_notificacoes
- encontrar_abrigo
- nao_receber_notificacoes
- parar_notificacoes
- mais_riscos
- corrigir_nome
- sair_consulta_risco
- corrigir_midias
- corrigir_classificacao
- corrigir_endereco
- just_listen
- agradecimento

actions:
- utter_menu_pos_lista
# - utter_pos_ajuda_dicas
- action_alterar_nome
- action_agendar_inatividade
- action_inatividade_timeout
- action_request_location
- action_corrigir_nome
- action_perguntar_nome
- action_salvar_nome
- utter_menu_inicial
- action_buscar_endereco_texto
- descrever_risco
- utter_classificar_risco
- action_classificar_risco_corrigir
- action_fallback_buttons
- action_repeat_last_message
- action_buscar_endereco
- action_salvar_classificacao_risco
- action_ask_descricao_risco
- action_salvar_descricao_risco
- utter_perguntar_por_midia
- action_salvar_midia_risco
- action_perguntar_por_nova_midia
- action_confirmar_relato
- action_recusar_risco
- action_salvar_risco
- action_listar_riscos
- action_perguntar_mais_riscos
- action_preciso_de_ajuda
- action_listar_abrigos
- action_listar_contatos_emergencia
# - utter_menu_dicas
# - action_buscar_dicas
- utter_ajuda
- utter_pos_ajuda
- action_receber_notificacoes
- utter_finalizar
- action_remover_notificacoes
- action_nivel_de_risco
- action_parar_notificacoes
- action_pergunta_notificacoes
- utter_saida_riscos
- action_sair
- action_corrigir_midias
- action_corrigir_endereco
- action_confirmar_relato_pos_midia
- action_agradecimento



slots:
  latitude:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
  longitude:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
  endereco:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
  pagina_risco:
    type: float
    influence_conversation: false
    initial_value: 1
    mappings:
      - type: custom
  nome:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
 
  classificacao_risco:
    type: text
    mappings:
      - type: from_entity
        entity: classificacao_risco
  # dicas:
  #   type: text
  #   mappings:
  #     - type: from_entity
  #       entity: dicas
  descricao_risco:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text
        intent: informar_descricao_risco
  midias:
    type: list
    influence_conversation: false
    mappings:
      - type: custom
  contexto_classificacao_corrigida:
    type: bool
    influence_conversation: true
    initial_value: false
    mappings:
      - type: custom
  contexto_endereco_corrigido:
    type: bool
    influence_conversation: true
    initial_value: false
    mappings:
      - type: custom

entities:
- nome
- classificacao_risco
# - dicas
responses:
  utter_menu_inicial:
  - text: | 
      Oi, {nome}! 
      Escolha uma op√ß√£o pra come√ßar:
    buttons:
    - title: Informar um risco
      payload: /informar_risco
    - title: Situa√ß√£o no Jacar√©
      payload: /situacao_no_jacare
    - title: Preciso de ajuda
      payload: /preciso_de_ajuda

  utter_menu_pos_lista:
  - text: | 
      Como podemos te ajudar agora? 
    buttons:
    - title: Informar um risco
      payload: /informar_risco
    - title: Preciso de ajuda
      payload: /preciso_de_ajuda
    - title: Menu inicial
      payload: /menu_inicial



  utter_classificar_risco:
  - text: "Perfeito {nome}. Voc√™ quer falar sobre:" 
    buttons:
    - title: Alagamento
      payload: '/informar_classificacao_risco{"classificacao_risco": "alagamento"}'
    - title: Lixo
      payload: '/informar_classificacao_risco{"classificacao_risco": "lixo"}'
    - title: Outros
      payload: '/informar_classificacao_risco{"classificacao_risco": "outros"}'
  

  utter_perguntar_por_midia:
  - text: | 
      üì∏ Se tiver uma *foto* ou *v√≠deo*, pode mandar por aqui ou clicar em pular para continuar. 
    buttons:
    - title: Pular
      payload: '/pular_enviar_midia_risco'

  utter_ajuda:
  - text: |
      Como podemos te ajudar agora?
    buttons:
    - title: Encontrar um abrigo
      payload: '/encontrar_abrigo'
    - title: Contatos emerg√™ncia
      payload: '/contatos_emergencia'
    # - title: Dicas de seguran√ßa
    #   payload: '/dicas_seguran√ßa'

  # utter_menu_dicas:
  # - text: |
  #     Voc√™ quer dicas para qual tipo de situa√ß√£o?
  #   buttons:
  #   - title: Enchente
  #     payload: '/dicas_de{"dicas": "enchente"}'    
  #   - title: Focos de lixo
  #     payload: '/dicas_de{"dicas": "lixo"}'
  #   - title: Calor extremo
  #     payload: '/dicas_de{"dicas": "calor"}'
    
  utter_pos_ajuda:
  - text: |
       Como podemos te ajudar agora?
    buttons:
    - title: Mais ajuda
      payload: '/ajuda'
    - title: Menu inicial
      payload: '/menu_inicial'
    - title: Encerrar
      payload: /sair

  # utter_pos_ajuda_dicas:
  # - text: |
  #      Como podemos te ajudar agora?
  #   buttons:
  #   - title: Outras situa√ß√µes
  #     payload: '/menu_dicas'
  #   - title: Menu inicial
  #     payload: '/menu_inicial'
  #   - title: Encerrar
  #     payload: /sair
  
  utter_saida_riscos:
  - text: |
      Te ajudo em algo mais? Voc√™ pode:
    buttons:
    - title: Preciso de ajuda
      payload: '/preciso_de_ajuda'
    - title: Menu inicial
      payload: '/menu_inicial'
    - title: Encerrar
      payload: /sair

  utter_finalizar:
  - text: |
       Certo! Se precisar de mais informa√ß√µes no futuro ou quiser compartilhar um novo risco, √© s√≥ voltar nessa conversa e mandar um ‚Äúoi‚Äù.
       Estamos por aqui pra ajudar no que for poss√≠vel! ü´Ç

